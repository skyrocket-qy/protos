syntax = "proto3";

package pkgpb.v1;

option go_package = "github.com/skyrocket-qy/protos/gen/pkgpb/v1;pkgpbv1";


enum Operator {
    OPERATOR_UNSPECIFIED = 0;
    EQ = 1;         // =
    NEQ = 2;        // !=
    GT = 3;         // >
    GTE = 4;        // >=
    LT = 5;         // <
    LTE = 6;        // <=
    IN = 7;         // IN (...)
    NOT_IN = 8;     // NOT IN (...)
    LIKE = 9;       // LIKE '...'
    ILIKE = 10;     // ILIKE '...'
    IS_NULL = 11;
    IS_NOT_NULL = 12;
    BETWEEN = 13;
}

enum LogicOp {
    LOGIC_OP_UNSPECIFIED = 0;
    AND = 1;
    OR = 2;
    NOT = 3;
}

message Filter {
    string field = 1;                 // e.g. "email", "created_at"
    Operator op = 2;           
    repeated string values = 3;      // can hold 1 or 2 values depending on op
}

message Sorter {
    string field = 1;
    bool asc = 2;
}

message Pager {
    int32 number = 1;
    int32 size = 2;
}

message Cursor {
    optional bytes val = 1;
    int32 size = 2;
}

message CursorData  {
	repeated Field fields = 1;
}

message Field  {
	string col = 1;
	bool   asc = 2;
	string val = 3;
}

message FilterNode {
  oneof node {
    Filter filter = 1;
    Logical logical = 2;
  }
}

message Logical {
  LogicOp op = 1;
  repeated FilterNode nodes = 2;
}